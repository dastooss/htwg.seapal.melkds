<html>
<head>
	<title>Karte</title>
	<!--<style type="text/css">
		html { height: 100% }
		body { height: 100%; margin: 0; padding: 0 }
		#map_canvas { height: 100% }
	</style>-->
	<!--CSS....-->
	<link rel="stylesheet" type="text/css" href="include/karte.css">
	
	
	<script type="text/javascript"!
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAAVHx_d1I9yUwYKlgVJle0su9PiwVODEk&sensor=false">
	</script>
	<!--Kontextmenü....-->
	<script language="JavaScript" src="js/kontextmenue.js"></script>
	
	<script type="text/javascript">
		/*var last_marker = new google.maps.Marker({
					position: null,
					map: null,
					icon: null,
					draggable: true
				});;*/
		
		var lastmarker;
		var routePoints = [];
		var markers = [];
		var map;
		var route;
	
		function initialize() {
		
			var mapOptions = {
				center: new google.maps.LatLng(47.66, 9.16),
				zoom: 14,
				mapTypeId: google.maps.MapTypeId.ROADMAP
			};
			map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);
			
			
			google.maps.event.addListener(map, 'center_changed', function() {
				var lat = map.getCenter().lat();
				var lng = map.getCenter().lng();
				var lat_h = Math.floor(lat);
				if(Math.abs(lat_h) < 10){
					if(lat_h < 0){
						lat_h = "-0" + Math.abs(lat_h);
					}else{
						lat_h = "0" + lat_h;
					}
				}
				
				var lat_m = Math.floor((lat - lat_h) * 10000)/100;
				if(lat_m < 10){
					lat_m = "0" + lat_m;
				}
				var lng_h = Math.floor(lng);
				if(Math.abs(lng_h) < 10){
					if(lng_h < 0){
						lng_h = "-00" + Math.abs(lng_h);
					}else{
						lng_h = "00" + lng_h;
					}
				}else if(Math.abs(lng_h) < 100){
					if(lng_h < 0){
						lng_h = "-0" + Math.abs(lng_h);
					}else{
						lng_h = "0" + lng_h;
					}
				}
				
				var lng_m = Math.floor((lng - lng_h) * 10000)/100;
				if(lng_m < 10){
					lng_m = "0" + lng_m;
				}
				document.getElementById("lat").firstChild.nodeValue=lat_h + "°" + lat_m + "'N";
				document.getElementById("long").firstChild.nodeValue=lng_h + "°" + lng_m + "'E";
			})
			
			google.maps.event.addListener(map, 'click', function(event) {
				if(lastmarker){
					lastmarker.setMap(null);
				}
				lastmarker = new google.maps.Marker({
					position: event.latLng,
					map: map,
					icon: "crosshair25px.png",
					draggable: true
				});
				
			})
		}
		
		//Marker setzen
		function marker(){
			if(lastmarker){
				lastmarker.setMap(null);
			}
			var marker = new google.maps.Marker({
				position: lastmarker.getPosition(),
				map: map,
				icon: "flagge32px.png",
				draggable: false
			});
			routePoints.push(marker.getPosition());
			markers.push(marker);
		}
		
		//Polyline
		function polyline(){
			route = new google.maps.Polyline({
				path: routePoints,
				strokeColor: "#FF0000",
				strokeOpacity: 1.0,
				strokeWeight: 2
			});
			route.setMap(map);
		}
		
		//Abstand
		function distance(){
		
		}
		
		//Löschen
		function deleteMarkers(){
			for(var i = 0; i < markers.length; i++){
				markers[i].setMap(null);
			}
			route.setMap(null);
		}
		
		
	</script>	
</head>
<body onload="initialize()">
	<h1>Latitude <span id="lat">47°66.00'N</span> Longitude <span id="long">009°16.00'E </span></h1>
	<div id="map_canvas" style="width:100%;height:100%"></div>
</body>
</html>